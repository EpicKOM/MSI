{% extends 'layout.html' %}
{% import "macros/observations_macros.html" as macros %}

{% block css %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/observations.css') }}">
{% endblock css %}

{% block observations_active %}
    active
{% endblock %}

{% block content %}
    <div class="container mt-4">
        <h3 class="text-light mb-3">
            <i class="fa-solid fa-map text-light me-2"></i>
            Cartes Météo
        </h3>
        <div class="row">
            <div class="col-lg-6">
                <div class="card bg-primary-color p-3 msi-border">
                    <h5 class="text-light text-center fw-normal mb-0">
                        Cartes météo
                    </h5>
                    <hr class="text-light mt-3 mb-3 opacity-25">
                    <iframe src="https://www.meteoblue.com/fr/meteo/cartes/widget/grenoble_france_3014728?windAnimation=0&windAnimation=1&gust=0&gust=1&satellite=0&satellite=1&cloudsAndPrecipitation=0&cloudsAndPrecipitation=1&temperature=0&temperature=1&sunshine=0&sunshine=1&extremeForecastIndex=0&extremeForecastIndex=1&geoloc=fixed&tempunit=C&windunit=km%252Fh&lengthunit=metric&zoom=8&autowidth=auto"  frameborder="0" scrolling="NO" allowtransparency="true" style="width: 100%; height: 575px;" class="rounded"></iframe>
                </div>
            </div>

            <div class="col-lg-6 mt-lg-0 mt-3">
                <div class="card bg-primary-color p-3 msi-border">
                    <h5 class="text-light text-center fw-normal mb-0">
                        Cartes de chaleur urbaine
                    </h5>
                    <hr class="text-light mt-3 mb-3 opacity-25">
                    <iframe src="https://www.meteoblue.com/fr/products/cityclimate/widget/grenoble?wind_map=0&wind_map=1&heading=0&webcams=0&webcams=1&share=0&share=1&info=0&info=1&autowidth=auto"  frameborder="0" scrolling="NO" allowtransparency="true" sandbox="allow-same-origin allow-scripts allow-popups allow-popups-to-escape-sandbox" style="width: 100%; height: 575px" class="rounded"></iframe>
                </div>
            </div>

        </div>
        <h3 class="text-light mt-3 mb-3">
            <i class="fa-solid fa-bell text-light me-2"></i>
            Alertes
        </h3>
        <div class="row">
            <div class="col-lg-6">
                <div class="card bg-primary-color p-3 msi-border">
                    <h5 class="text-light text-center">Vigilance Isère (38)</h5>
                    <div class="text-center {{ macros.text_color_class(weather_alert['max_color_id']) }}">
                        <i class="fa-solid fa-circle fa-fw me-2"></i>{{ weather_alert["max_alert_message"] }}
                    </div>
                    <hr class="text-light">
                    <ul class="nav mb-3 ms-auto me-auto" role="tablist">
                        <li class="nav-item me-3" role="presentation">
                            <a data-mdb-tab-init class="nav-link nav-weather-alert text-light opacity-50 active tab-active" id="todayTab" href="#todayTabContent" role="tab">
                                Aujourd'hui
                            </a>
                        </li>
                        <li class="nav-item ms-3" role="presentation">
                            <a data-mdb-tab-init class="nav-link nav-weather-alert text-light opacity-50" id="tomorrowTab" href="#tomorrowTabContent" role="tab">
                                Demain
                            </a>
                        </li>
                    </ul>
                    <!-- Tabs content -->
                    <div class="tab-content">
                        <div class="tab-pane fade show active" id="todayTabContent" role="tabpanel">
                            <ul class="list-group list-group-light weather-alerts" style="border: None;">
                                {% for item in weather_alert["results"] %}
                                    <li class="list-group-item d-flex justify-content-between align-items-center ms-4 me-4 alert-item-border">
                                        <div>
                                            <div class="text-light">{{ item['phenomenon'] }}</div>
                                        </div>
                                        <span class="badge rounded-pill {{ macros.bg_color_class(item['color_id']) }}">{{ item['alert_message'] }}</span>
                                    </li>
                                {% endfor %}
                            </ul>
                        </div>
                        <div class="tab-pane fade" id="tomorrowTabContent" role="tabpanel" style="display: none">
                            <ul class="list-group list-group-light weather-alerts" style="border: None;">
                                <li class="list-group-item d-flex justify-content-between align-items-center ms-4 me-4 alert-item-border">
                                    <div>
                                        <div class="text-light">Avalanches</div>
                                    </div>
                                    <span class="badge rounded-pill bg-danger text-dark">Vigilance absolue</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-6 mt-lg-0 mt-3">
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12 mt-3">
                <div class="card bg-primary-color p-3 msi-border">
                    <h5 class="text-light text-center">Indice Qualité de l'Air</h5>
                    <ul class="nav ms-auto me-auto mt-2 mb-2" role="tablist">
                        <li class="nav-item me-1" role="presentation">
                            <a data-mdb-tab-init class="nav-link text-light active opacity-50 tab-active" role="tab">
                                Aujourd'hui
                            </a>
                        </li>
                        <li class="nav-item ms-1" role="presentation">
                            <a data-mdb-tab-init class="nav-link text-light opacity-50" role="tab">
                                Demain
                            </a>
                        </li>
                    </ul>
                    <!-- Flex container -->
                    <div class="d-flex justify-content-center gap-3 align-items-center mt-4 mb-4">

                        <!-- Icône 1 -->
                        <div data-mdb-toggle="tooltip" title="Très bon">
                            <img src="{{ url_for('static', filename='img/atmo_indice_1.svg') }}" alt="Très bon" width="100" height="100">
                        </div>

                        <!-- Icône 2 -->
                        <div data-mdb-toggle="tooltip" title="Bon">
                            <img src="{{ url_for('static', filename='img/atmo_indice_2.svg') }}" alt="Bon" width="60" height="60">
                        </div>

                        <!-- Icône 3 -->
                        <div data-mdb-toggle="tooltip" title="Moyen">
                            <img src="{{ url_for('static', filename='img/atmo_indice_3.svg') }}" alt="Moyen" width="60" height="60">
                        </div>

                        <!-- Icône 4 (Actif) -->
                        <div data-mdb-toggle="tooltip" title="Mauvais">
                            <img src="{{ url_for('static', filename='img/atmo_indice_4.svg') }}" alt="Mauvais" width="60" height="60" class="active-icon">
                        </div>

                        <!-- Icône 5 -->
                        <div data-mdb-toggle="tooltip" title="Très mauvais">
                            <img src="{{ url_for('static', filename='img/atmo_indice_5.svg') }}" alt="Très mauvais" width="60" height="60">
                        </div>

                        <!-- Icône 6 -->
                        <div data-mdb-toggle="tooltip" title="Dangereux">
                            <img src="{{ url_for('static', filename='img/atmo_indice_6.svg') }}" alt="Dangereux" width="60" height="60">
                        </div>
                    </div>
                    <h6 class="text-danger text-center">BON</h6>

                    <hr class="text-light mt-3 mb-3">

                    <div class="">
                        <span class="badge p-3 bg-active-color border-active text-info">
                            <i class="fa-solid fa-info me-2"></i>Données pour le 09/06/2025
                        </span>
                    </div>

                    <div class="row mt-4">
                        <div class="col-lg-8">
                            <div class="row">
                                <div class="col-xl-4 col-md-6 col-sm-6 col-12 mb-4">
                                    <div class="d-flex align-items-center">
                                        <i class="fa-solid fa-circle fa-2x text-success"></i>
                                        <div class="ms-3 text-light">
                                            <p class="fw-bold mb-1">Multi-polluants</p>
                                            <p class="mb-0">&nbsp;</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xl-4 col-md-6 col-sm-6 col-12 mb-4">
                                    <div class="d-flex align-items-center">
                                        <i class="fa-solid fa-circle fa-2x text-success"></i>
                                        <div class="ms-3 text-light">
                                            <p class="fw-bold mb-1">Dioxyde d'azote</p>
                                            <p class="mb-0">18 µg/m<sup>3</sup></p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xl-4 col-md-6 col-sm-6 col-12 mb-4">
                                    <div class="d-flex align-items-center">
                                        <i class="fa-solid fa-circle fa-2x text-success"></i>
                                        <div class="ms-3 text-light">
                                            <p class="fw-bold mb-1">Ozone</p>
                                            <p class="mb-0">126 µg/m<sup>3</sup></p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xl-4 col-md-6 col-sm-6 col-12 mb-4">
                                    <div class="d-flex align-items-center">
                                        <i class="fa-solid fa-circle fa-2x text-success"></i>
                                        <div class="ms-3 text-light">
                                            <p class="fw-bold mb-1">Dioxyde de soufre</p>
                                            <p class="mb-0">2.61 µg/m<sup>3</sup></p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xl-4 col-md-6 col-sm-6 col-12 mb-4">
                                    <div class="d-flex align-items-center">
                                        <i class="fa-solid fa-circle fa-2x text-success"></i>
                                        <div class="ms-3 text-light">
                                            <p class="fw-bold mb-1">PM10</p>
                                            <p class="mb-0">41 µg/m<sup>3</sup></p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xl-4 col-md-6 col-sm-6 col-12 mb-4">
                                    <div class="d-flex align-items-center">
                                        <i class="fa-solid fa-circle fa-2x text-success"></i>
                                        <div class="ms-3 text-light">
                                            <p class="fw-bold mb-1">PM2.5</p>
                                            <p class="mb-0">27 µg/m<sup>3</sup></p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <div class="row">
                                <p class="fw-bold text-light">Légende</p>
                                <div class="col-md-6 mb-4">
                                    <div class="d-flex align-items-center text-light">
                                        <i class="fa-solid fa-circle text-success me-2"></i>
                                        <p class="mb-0">Bon</p>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-4">
                                    <div class="d-flex align-items-center text-light">
                                        <i class="fa-solid fa-circle text-success me-2"></i>
                                        <p class="mb-0">Dégradé</p>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <h3 class="text-light mt-3 mb-3">
            <i class="fa-solid fa-mountain text-light me-2"></i>
            Météo Montagne
        </h3>
        <div class="row">
            <div class="col-lg-12">
                <div class="card bg-primary-color p-3 msi-border">
                    <!-- Tabs navs -->
                    <ul class="nav mb-3 ms-auto me-auto" role="tablist">
                        <li class="nav-item me-3" role="presentation">
                            <a data-mdb-tab-init class="nav-link nav-mountain-weather text-light opacity-50 active tab-active" id="snowTab" href="#snowTabContent" role="tab">
                                <i class="fas fa-snowflake fa-fw me-2"></i>Enneigement
                            </a>
                        </li>
                        <li class="nav-item ms-3" role="presentation">
                            <a data-mdb-tab-init class="nav-link nav-mountain-weather text-light opacity-50" id="avalancheTab" href="#avalancheTabContent" role="tab">
                                <i class="fas fa-hill-avalanche fa-fw me-2"></i>Risques-avalanche
                            </a>
                        </li>
                    </ul>
                    <!-- Tabs navs -->
                    <div class="row mt-3">
                        <div class="col-lg-4">
                            <h5 class="text-light text-center fw-bold">Isère (38)</h5>
                            <hr class="text-light">
                            <div class="text-center">
                                <button type="button" class="btn btn-outline-info mx-1 my-1 mountain-button action-item bg-active-color action-item-disabled" data-mdb-ripple-init data-mdb-ripple-color="dark" data-value="belledonne">Belledonne</button>
                                <button type="button" class="btn btn-outline-info mx-1 my-1 mountain-button action-item" data-mdb-ripple-init data-mdb-ripple-color="dark" data-value="chartreuse">Chartreuse</button>
                                <button type="button" class="btn btn-outline-info mx-1 my-1 mountain-button action-item" data-mdb-ripple-init data-mdb-ripple-color="dark" data-value="grandes_rousses">Grandes Rousses</button>
                                <button type="button" class="btn btn-outline-info mx-1 my-1 mountain-button action-item" data-mdb-ripple-init data-mdb-ripple-color="dark" data-value="oisans">Oisans</button>
                                <button type="button" class="btn btn-outline-info mx-1 my-1 mountain-button action-item" data-mdb-ripple-init data-mdb-ripple-color="dark" data-value="vercors">Vercors</button>
                            </div>
                        </div>
                        <div class="col-lg-4 mt-lg-0 mt-3">
                            <h5 class="text-light text-center fw-bold">Savoie (73)</h5>
                            <hr class="text-light">
                            <div class="text-center">
                                <button type="button" class="btn btn-outline-info mx-1 my-1 mountain-button action-item" data-mdb-ripple-init data-mdb-ripple-color="dark" data-value="bauges">Bauges</button>
                                <button type="button" class="btn btn-outline-info mx-1 my-1 mountain-button action-item" data-mdb-ripple-init data-mdb-ripple-color="dark" data-value="beaufortain">Beaufortain</button>
                                <button type="button" class="btn btn-outline-info mx-1 my-1 mountain-button action-item" data-mdb-ripple-init data-mdb-ripple-color="dark" data-value="haute_maurienne">Haute-Maurienne</button>
                                <button type="button" class="btn btn-outline-info mx-1 my-1 mountain-button action-item" data-mdb-ripple-init data-mdb-ripple-color="dark" data-value="haute_tarentaise">Haute-Tarentaise</button>
                                <button type="button" class="btn btn-outline-info mx-1 my-1 mountain-button action-item" data-mdb-ripple-init data-mdb-ripple-color="dark" data-value="vanoise">Vanoise</button>
                            </div>
                        </div>
                        <div class="col-lg-4 mt-lg-0 mt-3">
                            <h5 class="text-light text-center fw-bold">Haute-Savoie (74)</h5>
                            <hr class="text-light">
                            <div class="text-center">
                                <button type="button" class="btn btn-outline-info mx-1 my-1 mountain-button action-item" data-mdb-ripple-init data-mdb-ripple-color="dark" data-value="mont_blanc">Mont-Blanc</button>
                            </div>
                        </div>
                    </div>
                    <hr class="text-light">
                    <!-- Tabs content -->
                    <div class="tab-content">
                        <div class="tab-pane fade show active" id="snowTabContent" role="tabpanel">
                            <div class="row">
                                <div class="col-lg-4 d-flex align-items-center">
                                    <h5 class="text-light fw-bold" id="massifTitle"></h5>
                                </div>
                                <div class="col-lg-3 ms-auto">
                                    <div class="dropdown custom-dropdown w-100">
                                        <button
                                            class="btn btn-hover bg-primary-color msi-border text-light dropdown-toggle w-100 d-flex justify-content-between align-items-center"
                                            type="button"
                                            data-mdb-dropdown-init
                                            data-mdb-ripple-init
                                            data-mdb-dropdown-animation="off"
                                            aria-expanded="false">
                                            <span id="snowCoveragePeriodSelectTitle">Semaine</span>
                                            <i class="fa-solid fa-sort fa-sm opacity-50"></i>
                                        </button>
                                        <ul class="dropdown-menu bg-primary-color msi-border w-100" aria-labelledby="dropdownMenuButton">
                                            <li><a class="dropdown-item text-light d-flex justify-content-between align-items-center action-item snow-coverage-selector action-item-disabled" data-value="week">Semaine<i class="fa-solid fa-check text-success"></i></a></li>
                                            <li><a class="dropdown-item text-light d-flex justify-content-between align-items-center action-item snow-coverage-selector" data-value="season">Saison</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <div class="row mt-3" id="snowCoverageContainer">
                                    <div class="col-lg-6 ms-auto me-auto text-center">
                                        <img class="img-fluid rounded" src="https://rpcache-aa.meteofrance.com/internet2018client/2.0/files/mountain/observations/AIGLES.gif" alt="Les données sont actuellement indisponibles">
                                    </div>
                                </div>
                                <p class="text-danger text-center" id="snowCoverageErrorMessage" style="display: none;">Données indisponibles</p>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="avalancheTabContent" role="tabpanel" style="display: none">
                            <div class="row mt-3">
                                <div class="col-lg-9 ms-auto me-auto" id="avalancheContainer">
                                    <iframe class="rounded" src="https://skitour.fr/neige/bulletin_avalanche_8.pdf" id="braFrame" style="height: 75vh;" width="100%" frameborder="0"></iframe>
                                    <p class="text-danger text-center" id="braErrorMessage" style="display: none;">Données indisponibles</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Tabs content -->
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block script %}
    <script src="{{ url_for('static', filename='js/page/observations.js') }}"></script>
{% endblock %}
